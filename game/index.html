<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pli & Mat - Chess Card Battle</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700;900&family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Main Menu Screen -->
    <div id="main-menu" class="main-menu" data-testid="main-menu">
        <h1 class="game-title" data-testid="game-title">Pli & Mat</h1>
        
        <div class="menu-container" data-testid="menu-container">
            <div class="menu-section">
                <label class="menu-label" for="color-select">Couleur</label>
                <div class="btn-group" role="group" aria-label="Color selection">
                    <button class="btn-secondary active" data-testid="select-white-button" data-color="white" aria-label="Play as white pieces">
                        <span class="piece-icon">♔</span> Blanc
                    </button>
                    <button class="btn-secondary" data-testid="select-black-button" data-color="black" aria-label="Play as black pieces">
                        <span class="piece-icon">♚</span> Noir
                    </button>
                </div>
            </div>
            
            <div class="menu-section">
                <label class="menu-label">Difficulté</label>
                <div class="btn-group" role="group" aria-label="Difficulty selection">
                    <button class="btn-secondary" data-testid="difficulty-easy-button" data-difficulty="easy" aria-label="Easy difficulty">Facile</button>
                    <button class="btn-secondary active" data-testid="difficulty-normal-button" data-difficulty="normal" aria-label="Normal difficulty">Normal</button>
                    <button class="btn-secondary" data-testid="difficulty-hard-button" data-difficulty="hard" aria-label="Hard difficulty">Difficile</button>
                </div>
            </div>
            
            <div class="menu-section">
                <label class="menu-label">Mode</label>
                <div class="btn-group" role="group" aria-label="Game mode selection">
                    <button class="btn-secondary active" data-testid="mode-pve-button" data-mode="pve" aria-label="Player vs AI mode">vs IA</button>
                    <button class="btn-secondary" data-testid="mode-pvp-button" data-mode="pvp" aria-label="Player vs player mode">Joueur vs Joueur</button>
                </div>
            </div>
            
            <button class="btn-primary" data-testid="start-game-button" id="start-game-btn" aria-label="Start new game">
                <i class="fa-solid fa-play"></i> Commencer
            </button>
            
            <button class="btn-secondary" data-testid="rules-toggle-button" id="rules-toggle-btn" aria-label="Toggle rules panel" style="margin-top: 1rem;">
                <i class="fa-solid fa-circle-info"></i> Règles du jeu
            </button>
        </div>
    </div>
    
    <!-- Game Board -->
    <div id="game-board" class="game-board hidden" data-testid="game-board">
        <!-- Top Bar -->
        <div class="top-bar">
            <button class="btn-icon" data-testid="back-to-menu-button" id="back-to-menu-btn" aria-label="Back to main menu">
                <i class="fa-solid fa-arrow-left"></i>
            </button>
            
            <div class="phase-indicator" data-testid="phase-indicator">
                <span class="phase-dot" data-phase="select"></span>
                <span class="phase-label" id="phase-label">Phase de Sélection</span>
            </div>
            
            <div class="top-bar-actions">
                <button class="btn-icon" data-testid="powers-legend-button" id="powers-legend-btn" aria-label="Afficher légende des pouvoirs">
                    <i class="fa-solid fa-book"></i>
                </button>
                <button class="btn-icon" data-testid="rules-toggle-game-button" id="rules-toggle-game-btn" aria-label="Toggle rules panel">
                    <i class="fa-solid fa-circle-info"></i>
                </button>
            </div>
        </div>
        
        <!-- Opponent Zone -->
        <div class="player-zone opponent" data-testid="opponent-zone">
            <div class="player-info">
                <div class="hp-counter" id="opponent-hp" data-testid="opponent-hp-counter" aria-label="Opponent health points">
                    <i class="fa-solid fa-heart"></i>
                    <span class="hp-value" data-testid="opponent-hp-value">12</span>
                    <span class="hp-label">HP</span>
                </div>
                <span class="player-label">Adversaire</span>
            </div>
            
            <div class="defense-zone" id="opponent-defense" data-testid="opponent-defense-zone" aria-label="Opponent defense zone"></div>
        </div>
        
        <!-- Combat Zone -->
        <div class="combat-zone" id="combat-zone" data-testid="combat-zone" aria-label="Combat zone">
            <div class="combat-card-slot" id="opponent-combat-slot" data-testid="opponent-combat-slot"></div>
            
            <div class="combat-center">
                <div class="first-player-token" id="first-player-token" data-testid="first-player-token" aria-label="First player indicator">
                    <i class="fa-solid fa-star"></i>
                    <span id="first-player-label">Premier Joueur</span>
                </div>
            </div>
            
            <div class="combat-card-slot" id="player-combat-slot" data-testid="player-combat-slot"></div>
        </div>
        
        <!-- Player Zone -->
        <div class="player-zone player" data-testid="player-zone">
            <div class="defense-zone" id="player-defense" data-testid="player-defense-zone" aria-label="Player defense zone"></div>
            
            <div class="player-info">
                <span class="player-label">Vous</span>
                <div class="hp-counter" id="player-hp" data-testid="player-hp-counter" aria-label="Player health points">
                    <i class="fa-solid fa-heart"></i>
                    <span class="hp-value" data-testid="player-hp-value">12</span>
                    <span class="hp-label">HP</span>
                </div>
            </div>
            
            <div class="hand-container" data-testid="hand-container" aria-label="Your hand of cards">
                <button class="hand-nav-btn prev" id="hand-prev-btn" aria-label="Previous cards">
                    <i class="fa-solid fa-chevron-left"></i>
                </button>
                <div class="hand-cards" id="player-hand"></div>
                <button class="hand-nav-btn next" id="hand-next-btn" aria-label="Next cards">
                    <i class="fa-solid fa-chevron-right"></i>
                </button>
            </div>
        </div>
        
        <!-- Action Panel -->
        <div class="action-panel hidden" id="action-panel" data-testid="action-panel">
            <div class="action-content">
                <h3 class="action-title" id="action-title">Choisissez une action</h3>
                <p class="action-description" id="action-description"></p>
                <div class="action-buttons" id="action-buttons"></div>
            </div>
        </div>
    </div>
    
    <!-- Powers Legend Panel -->
    <div id="powers-legend" class="powers-legend hidden" data-testid="powers-legend">
        <div class="legend-content">
            <div class="legend-header">
                <h3 class="legend-title">Légende des Pouvoirs</h3>
                <button class="btn-icon" id="close-legend-btn" aria-label="Fermer légende">
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>
            
            <div class="legend-section">
                <h4 class="legend-subtitle">Attaque (depuis la main)</h4>
                <div class="power-row">
                    <i class="fa-solid fa-crown power-icon crown"></i>
                    <span class="power-name">Couronne</span>
                    <span class="power-desc">Bat tout (Reine)</span>
                </div>
                <div class="power-row">
                    <i class="fa-solid fa-file power-icon paper"></i>
                    <span class="power-name">Papier</span>
                    <span class="power-desc">Bat Pierre (Tour)</span>
                </div>
                <div class="power-row">
                    <i class="fa-solid fa-hand-fist power-icon rock"></i>
                    <span class="power-name">Pierre</span>
                    <span class="power-desc">Bat Ciseaux (Cavalier)</span>
                </div>
                <div class="power-row">
                    <i class="fa-solid fa-scissors power-icon scissors"></i>
                    <span class="power-name">Ciseaux</span>
                    <span class="power-desc">Bat Papier (Fou)</span>
                </div>
            </div>
            
            <div class="legend-section">
                <h4 class="legend-subtitle">Défense (transformation!)</h4>
                <div class="power-row">
                    <span class="piece-label">♛ Reine →</span>
                    <i class="fa-solid fa-crown power-icon crown"></i>
                    <span class="power-name">Couronne</span>
                </div>
                <div class="power-row highlight">
                    <span class="piece-label">♜ Tour →</span>
                    <i class="fa-solid fa-hand-fist power-icon rock"></i>
                    <span class="power-name">Pierre</span>
                </div>
                <div class="power-row">
                    <span class="piece-label">♝ Fou →</span>
                    <i class="fa-solid fa-scissors power-icon scissors"></i>
                    <span class="power-name">Ciseaux</span>
                </div>
                <div class="power-row highlight">
                    <span class="piece-label">♞ Cavalier →</span>
                    <i class="fa-solid fa-file power-icon paper"></i>
                    <span class="power-name">Papier</span>
                </div>
                <div class="power-row">
                    <span class="piece-label">♟ Pions →</span>
                    <span class="power-desc-small">8&3=Pierre, 7&4=Ciseaux, 6&5=Papier, 2&1=Couronne</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Rules Panel